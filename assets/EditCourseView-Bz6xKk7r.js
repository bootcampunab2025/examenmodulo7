import{j as x,n as c,c as L,Q as U,p as z,ab as A,q as B,s as $,f as o,v,e as b,w as r,g as a,l as i,a9 as D,aa as I,D as N,o as d,E as m,i as l,t as S}from"./index-X-bycsv7.js";import{_ as j,b as y,a as q}from"./BFormInput.vue_vue_type_script_setup_true_lang-B9E5yJEs-D01ZjKa0.js";import{d as F,b as M,f as R}from"./BCard.vue_vue_type_script_setup_true_lang-BAaV9t2h-BU-rssmR.js";import{u as Q}from"./courses-BqikZZxM.js";import{C as T}from"./CourseForm-C7oZcSap.js";const G={class:"d-flex justify-content-between align-items-center"},H={key:0,class:"text-center my-5"},J={key:0,class:"spinner-border spinner-border-sm me-2"},K={__name:"EditCourseView",setup(O){const C=A(),k=N(),t=Q(),g=c(null),f=c(!1),s=c(null),p=c(null),_=L(()=>s.value?s.value.codigo&&s.value.nombre&&s.value.descripcion&&s.value.precio&&s.value.duracion&&s.value.cupos&&s.value.img:!1),V=n=>{s.value={...n}},E=()=>{f.value=!0},w=async()=>{if(!s.value||!p.value)return;const n={...s.value,precio:parseInt(s.value.precio),cupos:parseInt(s.value.cupos),inscritos:parseInt(s.value.inscritos)},e=await t.updateCourse(p.value.id,n);f.value=!1,e.success&&k.push("/admin")};return U(()=>t.allCourses,n=>{if(n.length>0&&C.params.id){const e=n.find(u=>u.id===C.params.id);e&&(p.value=e,s.value={...e})}},{immediate:!0}),z(()=>{if(t.allCourses.length===0)g.value=t.initCoursesListener();else{const n=t.allCourses.find(e=>e.id===C.params.id);n&&(p.value=n,s.value={...n})}}),B(()=>{g.value&&g.value()}),(n,e)=>(d(),$("div",null,[o(a(j),{class:"mb-4"},{default:r(()=>[o(a(q),null,{default:r(()=>[i("div",G,[e[6]||(e[6]=i("div",null,[i("h1",{class:"h2 mb-1"},"Editar Curso"),i("p",{class:"text-muted mb-0"},"Modifica la información del curso")],-1)),o(a(m),{variant:"outline-secondary",onClick:e[0]||(e[0]=u=>n.$router.push("/admin"))},{default:r(()=>[...e[5]||(e[5]=[l(" ← Volver ",-1)])]),_:1})])]),_:1})]),_:1}),a(t).isLoading?(d(),$("div",H,[o(a(D),{variant:"primary",class:"me-2"}),e[7]||(e[7]=i("span",null,"Cargando curso...",-1))])):v("",!0),a(t).getError?(d(),b(a(y),{key:1,variant:"danger",class:"mb-4"},{default:r(()=>[l(" Error: "+S(a(t).getError),1)]),_:1})):v("",!0),s.value&&!a(t).isLoading?(d(),b(a(F),{key:2},{default:r(()=>[o(a(M),null,{default:r(()=>[o(T,{course:s.value,onUpdateCourse:V},null,8,["course"])]),_:1}),o(a(R),{class:"text-end"},{default:r(()=>[o(a(m),{variant:"secondary",class:"me-2",onClick:e[1]||(e[1]=u=>n.$router.push("/admin"))},{default:r(()=>[...e[8]||(e[8]=[l(" Cancelar ",-1)])]),_:1}),o(a(m),{variant:"primary",onClick:E,disabled:!_.value||a(t).isLoading},{default:r(()=>[...e[9]||(e[9]=[l(" Actualizar Curso ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})):v("",!0),!s.value&&!a(t).isLoading&&!a(t).getError?(d(),b(a(y),{key:3,variant:"warning"},{default:r(()=>[e[11]||(e[11]=i("h4",{class:"alert-heading"},"Curso no encontrado",-1)),e[12]||(e[12]=i("p",null,"El curso que intentas editar no existe o ha sido eliminado.",-1)),e[13]||(e[13]=i("hr",null,null,-1)),o(a(m),{variant:"outline-warning",onClick:e[2]||(e[2]=u=>n.$router.push("/admin"))},{default:r(()=>[...e[10]||(e[10]=[l(" Volver a Administración ",-1)])]),_:1})]),_:1})):v("",!0),o(a(I),{modelValue:f.value,"onUpdate:modelValue":e[4]||(e[4]=u=>f.value=u),title:"Confirmar Actualización",centered:""},{footer:r(()=>[o(a(m),{variant:"secondary",onClick:e[3]||(e[3]=u=>f.value=!1)},{default:r(()=>[...e[14]||(e[14]=[l(" Cancelar ",-1)])]),_:1}),o(a(m),{variant:"primary",onClick:w,disabled:a(t).isLoading},{default:r(()=>[a(t).isLoading?(d(),$("span",J)):v("",!0),e[15]||(e[15]=l(" Actualizar ",-1))]),_:1},8,["disabled"])]),default:r(()=>[e[16]||(e[16]=i("p",null,"¿Deseas actualizar este curso?",-1))]),_:1},8,["modelValue"])]))}},h=x(K,[["__scopeId","data-v-15daa2a8"]]);export{h as default};
