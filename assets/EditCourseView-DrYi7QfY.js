import{j as S,n as d,c as B,s as I,p as N,Q as D,q as M,v as k,f as l,x as c,e as b,w as t,g as a,l as n,J as j,K as V,B as q,o as m,G as f,i,t as w}from"./index-CnDOF7Do.js";import{_ as E}from"./BAlert.vue_vue_type_script_setup_true_lang-BoLIpZFk-BMwzMJkR.js";import{d as F,b as R,f as G}from"./BCard.vue_vue_type_script_setup_true_lang-BAaV9t2h-CIFWF0FW.js";import{_ as H,a as J}from"./BFormInput.vue_vue_type_script_setup_true_lang-B9E5yJEs-B8Rcxc3z.js";import{u as K}from"./courses-BUTPmGTd.js";import{C as O}from"./CourseForm-B3_aL1fp.js";const Q={class:"d-flex justify-content-between align-items-center"},T={key:0,class:"text-center my-5"},P={key:0,class:"spinner-border spinner-border-sm me-2"},W={class:"mb-0"},X={__name:"EditCourseView",setup(Y){const g=D(),x=q(),o=K(),$=d(null),v=d(!1),s=d(null),C=d(null),p=d(!1),y=d(""),U=B(()=>s.value?s.value.codigo&&s.value.nombre&&s.value.descripcion&&s.value.precio&&s.value.duracion&&s.value.cupos&&s.value.img:!1),L=r=>{s.value={...r}},z=()=>{v.value=!0},A=async()=>{if(!s.value||!C.value)return;const r={...s.value,precio:parseInt(s.value.precio),cupos:parseInt(s.value.cupos),inscritos:parseInt(s.value.inscritos)},e=await o.updateCourse(C.value.id,r);v.value=!1,e.success&&(y.value="El curso fue actualizado correctamente.",p.value=!0)},_=()=>{p.value&&(p.value=!1,x.push("/admin"))};return I(()=>o.allCourses,r=>{if(r.length>0&&g.params.id){const e=r.find(u=>u.id===g.params.id);e&&(C.value=e,s.value={...e})}},{immediate:!0}),N(()=>{if(o.allCourses.length===0)$.value=o.initCoursesListener();else{const r=o.allCourses.find(e=>e.id===g.params.id);r&&(C.value=r,s.value={...r})}}),M(()=>{$.value&&$.value()}),(r,e)=>(m(),k("div",null,[l(a(H),{class:"mb-4"},{default:t(()=>[l(a(J),null,{default:t(()=>[n("div",Q,[e[7]||(e[7]=n("div",null,[n("h1",{class:"h2 mb-1"},"Editar Curso"),n("p",{class:"text-muted mb-0"},"Modifica la información del curso")],-1)),l(a(f),{variant:"outline-secondary",onClick:e[0]||(e[0]=u=>r.$router.push("/admin"))},{default:t(()=>[...e[6]||(e[6]=[i(" ← Volver ",-1)])]),_:1})])]),_:1})]),_:1}),a(o).isLoading?(m(),k("div",T,[l(a(j),{variant:"primary",class:"me-2"}),e[8]||(e[8]=n("span",null,"Cargando curso...",-1))])):c("",!0),a(o).getError?(m(),b(a(E),{key:1,variant:"danger",class:"mb-4"},{default:t(()=>[i(" Error: "+w(a(o).getError),1)]),_:1})):c("",!0),s.value&&!a(o).isLoading?(m(),b(a(F),{key:2},{default:t(()=>[l(a(R),null,{default:t(()=>[l(O,{course:s.value,onUpdateCourse:L},null,8,["course"])]),_:1}),l(a(G),{class:"text-end"},{default:t(()=>[l(a(f),{variant:"secondary",class:"me-2",onClick:e[1]||(e[1]=u=>r.$router.push("/admin"))},{default:t(()=>[...e[9]||(e[9]=[i(" Cancelar ",-1)])]),_:1}),l(a(f),{variant:"primary",onClick:z,disabled:!U.value||a(o).isLoading},{default:t(()=>[...e[10]||(e[10]=[i(" Actualizar Curso ",-1)])]),_:1},8,["disabled"])]),_:1})]),_:1})):c("",!0),!s.value&&!a(o).isLoading&&!a(o).getError?(m(),b(a(E),{key:3,variant:"warning"},{default:t(()=>[e[12]||(e[12]=n("h4",{class:"alert-heading"},"Curso no encontrado",-1)),e[13]||(e[13]=n("p",null,"El curso que intentas editar no existe o ha sido eliminado.",-1)),e[14]||(e[14]=n("hr",null,null,-1)),l(a(f),{variant:"outline-warning",onClick:e[2]||(e[2]=u=>r.$router.push("/admin"))},{default:t(()=>[...e[11]||(e[11]=[i(" Volver a Administración ",-1)])]),_:1})]),_:1})):c("",!0),l(a(V),{modelValue:v.value,"onUpdate:modelValue":e[4]||(e[4]=u=>v.value=u),title:"Confirmar Actualización",centered:""},{footer:t(()=>[l(a(f),{variant:"secondary",onClick:e[3]||(e[3]=u=>v.value=!1)},{default:t(()=>[...e[15]||(e[15]=[i(" Cancelar ",-1)])]),_:1}),l(a(f),{variant:"primary",onClick:A,disabled:a(o).isLoading},{default:t(()=>[a(o).isLoading?(m(),k("span",P)):c("",!0),e[16]||(e[16]=i(" Actualizar ",-1))]),_:1},8,["disabled"])]),default:t(()=>[e[17]||(e[17]=n("p",null,"¿Deseas actualizar este curso?",-1))]),_:1},8,["modelValue"]),l(a(V),{modelValue:p.value,"onUpdate:modelValue":e[5]||(e[5]=u=>p.value=u),title:"Actualización exitosa",centered:"","ok-only":"","ok-title":"Aceptar",onOk:_,onHidden:_},{default:t(()=>[n("p",W,w(y.value),1)]),_:1},8,["modelValue"])]))}},oe=S(X,[["__scopeId","data-v-945f61c0"]]);export{oe as default};
