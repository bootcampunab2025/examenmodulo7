import{c as v,R as Me,ah as Ze,d as X,u as ae,Y as Ne,b as Qe,v as T,o as g,l as ve,r as m,ac as L,ai as Be,a4 as We,A as I,m as _,U as Ee,V as Ue,X as Re,s as oe,n as ze,aj as we,ak as Se,al as et,a5 as He,p as tt,am as qe,an as at,ao as Ye,e as K,ap as ot,w as k,y as le,x as U,i as se,t as te,g as d,aq as Ce,F as ee,f as O,ar as N,Z as lt,as as Je,D as st,at as rt,h as nt,au as Ke,av as Oe,aw as je,ax as xe,ay as it,H as dt}from"./index-CnDOF7Do.js";const ut=(p,w="px")=>v(()=>{const l=Me(p),s=Me(w);return Ze.test(String(l))?`${Number(l)}${s}`:l}),Fe=(p,{preventDefault:w=!0,propagation:l=!1,immediatePropagation:s=!1}={})=>{w&&p.preventDefault(),l&&p.stopPropagation(),s&&p.stopImmediatePropagation()},ct="300px",ft=X({__name:"BTableSimple",props:{bordered:{type:Boolean,default:!1},borderless:{type:Boolean,default:!1},borderVariant:{default:null},captionTop:{type:Boolean,default:!1},dark:{type:Boolean,default:!1},fixed:{type:Boolean,default:!1},hover:{type:Boolean,default:!1},id:{default:void 0},noBorderCollapse:{type:Boolean,default:!1},outlined:{type:Boolean,default:!1},responsive:{type:[Boolean,String],default:!1},small:{type:Boolean,default:!1},stacked:{type:[Boolean,String],default:!1},stickyHeader:{type:[Boolean,String,Number],default:!1},striped:{type:Boolean,default:!1},stripedColumns:{type:Boolean,default:!1},variant:{default:null},tableAttrs:{default:void 0},tableClass:{default:void 0}},setup(p){const l=ae(p,"BTableSimple"),s=Ne(()=>l.id),t=Qe(v(()=>({borderVariant:l.borderVariant}))),y=v(()=>[l.tableClass,"table","b-table",t.value,{border:l.outlined,"table-bordered":l.bordered,"table-borderless":l.borderless,"caption-top":l.captionTop,"table-dark":l.dark,"table-hover":l.hover,"b-table-stacked":l.stacked===!0,[`b-table-stacked-${l.stacked}`]:typeof l.stacked=="string","table-striped":l.striped,"table-sm":l.small,[`table-${l.variant}`]:l.variant!==null,"table-striped-columns":l.stripedColumns,"b-table-fixed":l.fixed,"b-table-no-border-collapse":l.noBorderCollapse}]),B=v(()=>({id:s.value,class:y.value,...l.tableAttrs})),M=ut(v(()=>(l.stickyHeader===!0?ct:l.stickyHeader)||NaN)),G=v(()=>l.stickyHeader!==!1),S=v(()=>l.responsive!==!1||G.value),z=v(()=>G.value?{maxHeight:M.value}:void 0),$=v(()=>({"table-responsive":l.responsive===!0,[`table-responsive-${l.responsive}`]:typeof l.responsive=="string","b-table-sticky-header":G.value}));return(j,F)=>S.value?(g(),T("div",{key:0,class:I($.value),style:We(z.value)},[ve("table",L(Be(B.value)),[m(j.$slots,"default")],16)],6)):(g(),T("table",L(_({key:1},B.value)),[m(j.$slots,"default")],16))}}),Ie=(p,w,l)=>{const s=N(p,w);return l&&typeof l=="function"?l(s,w,p):s},Y=p=>typeof p=="object"&&p!==null,ie=p=>typeof p=="object"&&p!==null&&"key"in p,vt=X({__name:"BTbody",props:{variant:{default:null}},setup(p){const l=ae(p,"BTbody"),s=v(()=>({[`thead-${l.variant}`]:l.variant!==null}));return(t,y)=>(g(),T("tbody",{class:I(s.value)},[m(t.$slots,"default")],2))}}),pt=["colspan","rowspan","data-label"],yt={key:0},ge=X({__name:"BTd",props:{colspan:{default:void 0},rowspan:{default:void 0},stackedHeading:{default:void 0},stickyColumn:{type:Boolean,default:!1},variant:{default:null}},setup(p){const l=ae(p,"BTd"),s=v(()=>({[`table-${l.variant}`]:l.variant!==null,"b-table-sticky-column":l.stickyColumn,"table-b-table-default":l.stickyColumn&&l.variant===null}));return(t,y)=>(g(),T("td",{class:I(s.value),colspan:d(l).colspan,rowspan:d(l).rowspan,"data-label":d(l).stackedHeading},[d(l).stackedHeading?(g(),T("div",yt,[m(t.$slots,"default")])):m(t.$slots,"default",{key:1})],10,pt))}}),Le=X({__name:"BTfoot",props:{variant:{default:null}},setup(p){const l=ae(p,"BTfoot"),s=v(()=>({[`table-${l.variant}`]:l.variant!==null}));return(t,y)=>(g(),T("tfoot",{class:I(s.value)},[m(t.$slots,"default")],2))}}),bt=["scope","colspan","rowspan","data-label"],mt={key:0},Ve=X({__name:"BTh",props:{colspan:{default:void 0},rowspan:{default:void 0},stackedHeading:{default:void 0},stickyColumn:{type:Boolean,default:!1},variant:{default:null},scope:{default:void 0}},setup(p){const l=ae(p,"BTh"),s=v(()=>({[`table-${l.variant}`]:l.variant!==null,"b-table-sticky-column":l.stickyColumn,"table-b-table-default":l.stickyColumn&&l.variant===null})),t=v(()=>l.scope?l.scope:l.colspan?"colgroup":l.rowspan?"rowgroup":"col");return(y,B)=>(g(),T("th",{scope:t.value,class:I(s.value),colspan:d(l).colspan,rowspan:d(l).rowspan,"data-label":d(l).stackedHeading},[d(l).stackedHeading!==void 0?(g(),T("div",mt,[m(y.$slots,"default")])):m(y.$slots,"default",{key:1})],10,bt))}}),gt=X({__name:"BThead",props:{variant:{default:null}},setup(p){const l=ae(p,"BThead"),s=v(()=>({[`table-${l.variant}`]:l.variant!==null}));return(t,y)=>(g(),T("thead",{class:I(s.value)},[m(t.$slots,"default")],2))}}),J=X({__name:"BTr",props:{variant:{default:null}},setup(p){const l=ae(p,"BTr"),s=v(()=>({[`table-${l.variant}`]:l.variant!==null}));return(t,y)=>(g(),T("tr",{class:I(s.value)},[m(t.$slots,"default")],2))}}),ht=["TD","TH","TR"],kt=["a","a *","button","button *","input:not(.disabled):not([disabled])","select:not(.disabled):not([disabled])","textarea:not(.disabled):not([disabled])",'[role="link"]','[role="link"] *','[role="button"]','[role="button"] *',"[tabindex]:not(.disabled):not([disabled])"].join(","),fe=p=>{if(!p||!p.target)return!1;const w=p.target;if("disabled"in w&&w.disabled||ht.indexOf(w.tagName)!==-1)return!1;if(w.closest(".dropdown-menu"))return!0;const l=w.tagName==="LABEL"?w:w.closest("label");if(l){const s=l.getAttribute("for"),t=s?document.getElementById(s):l.querySelector("input, select, textarea");if(t&&!t.disabled)return!0}return w.matches(kt)},wt={key:0},St={key:0,class:"b-table-stacked-label"},Ct={class:"d-inline-flex flex-nowrap align-items-center gap-1"},Bt={key:3},_t=X({__name:"BTableLite",props:{align:{default:void 0},caption:{default:void 0},detailsTdClass:{default:void 0},fieldColumnClass:{type:[Function,String,Object,Array],default:void 0},fields:{default:()=>[]},footClone:{type:Boolean,default:!1},footRowVariant:{default:void 0},footVariant:{default:void 0},headRowVariant:{default:void 0},headVariant:{default:void 0},items:{default:()=>[]},labelStacked:{type:Boolean,default:!1},modelValue:{default:void 0},primaryKey:{default:void 0},tbodyClass:{default:void 0},tbodyTrAttrs:{type:[Function,Object],default:void 0},tbodyTrClass:{type:[Function,String,Array,Object],default:void 0},tfootClass:{default:void 0},tfootTrClass:{default:void 0},theadClass:{default:void 0},theadTrClass:{default:void 0},bordered:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},borderVariant:{default:void 0},captionTop:{type:Boolean,default:void 0},dark:{type:Boolean,default:void 0},fixed:{type:Boolean,default:void 0},hover:{type:Boolean,default:void 0},id:{default:void 0},noBorderCollapse:{type:Boolean,default:void 0},outlined:{type:Boolean,default:void 0},responsive:{type:[Boolean,String],default:void 0},small:{type:Boolean,default:void 0},stacked:{type:[Boolean,String],default:void 0},stickyHeader:{type:[Boolean,String,Number],default:void 0},striped:{type:Boolean,default:void 0},stripedColumns:{type:Boolean,default:void 0},variant:{default:void 0},tableAttrs:{},tableClass:{default:void 0}},emits:["head-clicked","row-clicked","row-dblclicked","row-contextmenu","row-hovered","row-unhovered","row-middle-clicked"],setup(p,{emit:w}){const s=ae(p,"BTableLite"),t=w,y=Ue(),B=lt(Je,null),M=Ne(()=>s.id),G=o=>[o,o._showDetails],S=ze(new WeakMap);oe(()=>s.items,o=>{o.forEach(c=>{Y(c)&&S.value.set(...G(c))})},{deep:!0,immediate:!0});const z=v(()=>[s.tableClass,{[`align-${s.align}`]:s.align!==void 0}]),$=v(()=>{if(!s.fields.length&&s.items.length){const[o]=s.items;return o&&(Y(o)||Array.isArray(o))?Object.keys(o).map(c=>{const a=we(c);return{key:c,label:a,tdAttr:Se(s,a)}}):[{key:"",_noHeader:!0}]}return s.fields.map(o=>{if(ie(o)){const a=o.label??we(o.key);return{...o,tdAttr:{...Se(s,a),...o.tdAttr}}}const c=we(o);return{key:o,label:c,tdAttr:Se(s,c)}})}),j=v(()=>$.value.length),F=v(()=>!(j.value>0&&$.value.every(o=>o._noHeader===!0))),A=v(()=>({variant:s.footVariant??s.headVariant,class:s.tfootClass??s.theadClass})),pe=o=>y[`foot(${String(o)})`]?`foot(${String(o)})`:y["foot()"]?"foot()":y[`head(${String(o)})`]?`head(${String(o)})`:"head()",re=(o,c,a)=>{const b=N(o,c);return a&&typeof a=="function"?a(b,c,o):a},ne=(o,c,a)=>{const b=String(c.key),i=N(o,b);return c.thAttr&&typeof c.thAttr=="function"?c.thAttr(i,b,o,a):c.thAttr},de=(o,c,a=!1)=>{t("head-clicked",o.key,o,c,a)},W=o=>{if(Y(o)){const c=S.value.get(o);S.value.set(o,!c),o._showDetails=!c}},he=o=>[o.class,o.thClass,{"b-table-sticky-column":o.stickyColumn},s.fieldColumnClass?typeof s.fieldColumnClass=="function"?s.fieldColumnClass(o):s.fieldColumnClass:null],q=(o,c)=>{const a=N(c,String(o.key));return[o.class,typeof o.tdClass=="function"?o.tdClass(a,String(o.key),c):o.tdClass,Y(c)&&c._cellVariants?.[o.key]?`table-${c._cellVariants?.[o.key]}`:null,{"b-table-sticky-column":o.stickyColumn}]},_e=(o,c,a)=>{a.button===1&&!fe(a)&&t("row-middle-clicked",o,c,a)},ue=(o,c)=>s.tbodyTrAttrs?typeof s.tbodyTrAttrs=="function"?s.tbodyTrAttrs(o,c):s.tbodyTrAttrs:null,P=(o,c)=>s.tbodyTrClass?typeof s.tbodyTrClass=="function"?s.tbodyTrClass(o,c):s.tbodyTrClass:null,Te=o=>`${M.value}__row_${o}`,$e=o=>o?.isRowHeader?Ve:ge,ke=o=>!!(B?.headerNavigation.value&&o.sortable===!0),Ae=v(()=>!!(B?.rowNavigation.value&&s.items.length>0)),ye=(o,c,a=!1)=>{const{target:b,code:i}=c;b&&b.tagName!=="TH"&&document.activeElement===b||(i==="Enter"||i==="Space")&&(Fe(c),de(o,c,a))},be=(o,c,a)=>{const{target:b,code:i,shiftKey:ce}=a;if(!(b&&b.tagName!=="TR"&&document.activeElement===b)){if(i==="Enter"||i==="Space"){Fe(a),t("row-clicked",o,c,a);return}(i===Ke||i===Oe||i===je||i===xe)&&(Fe(a),Pe(i,ce,c))}},Pe=(o,c,a)=>{const b=Array.from(document.querySelectorAll(`#${M.value} tbody tr[tabindex]`));if(b.length===0)return;let i=a;o===Ke?c?i=b.length-1:i=Math.min(a+1,b.length-1):o===Oe?c?i=0:i=Math.max(a-1,0):o===xe?i=b.length-1:o===je&&(i=0),i!==a&&b[i]&&b[i].focus()},V=v(()=>({...qe(s,Ye),tableClass:z.value,id:M.value}));return(o,c)=>(g(),K(ft,L(Be(V.value)),{default:k(()=>[y["table-colgroup"]?(g(),T("colgroup",wt,[m(o.$slots,"table-colgroup",{fields:$.value})])):U("",!0),st(O(gt,{variant:d(s).headVariant,class:I(d(s).theadClass)},{default:k(()=>[m(o.$slots,"thead-top",{columns:j.value,fields:$.value}),O(J,{variant:d(s).headRowVariant,class:I(d(s).theadTrClass)},{default:k(()=>[(g(!0),T(ee,null,le($.value,a=>(g(),K(Ve,_({key:a.key,scope:a.scope,class:he(a),title:a.headerTitle,variant:a.variant,abbr:a.headerAbbr,style:a.thStyle,tabindex:ke(a)?"0":void 0},{ref_for:!0},ne(null,a,"top"),{onClick:b=>de(a,b),onKeydown:b=>ye(a,b)}),{default:k(()=>[m(o.$slots,y[`head(${String(a.key)})`]?`head(${String(a.key)})`:"head()",{label:a.label,column:a.key,field:a,isFoot:!1},()=>[se(te(d(Ce)(a)),1)])]),_:2},1040,["scope","class","title","variant","abbr","style","tabindex","onClick","onKeydown"]))),128))]),_:3},8,["variant","class"]),y["thead-sub"]?(g(),K(J,{key:0},{default:k(()=>[(g(!0),T(ee,null,le($.value,a=>(g(),K(ge,{key:a.key,scope:"col",variant:a.variant,class:I([a.class,a.thClass])},{default:k(()=>[m(o.$slots,"thead-sub",{items:d(s).items,fields:$.value,field:a},()=>[se(te(a.label),1)])]),_:2},1032,["variant","class"]))),128))]),_:3})):U("",!0)]),_:3},8,["variant","class"]),[[rt,F.value]]),O(vt,{class:I(d(s).tbodyClass)},{default:k(()=>[m(o.$slots,"custom-body",{fields:$.value,items:d(s).items,columns:j.value},()=>[!d(s).stacked&&y["top-row"]?(g(),K(J,_({key:0,class:P(null,"row-top")},ue(null,"row-top")),{default:k(()=>[m(o.$slots,"top-row",{columns:j.value,fields:$.value})]),_:3},16,["class"])):U("",!0),(g(!0),T(ee,null,le(d(s).items,(a,b)=>(g(),T(ee,{key:d(s).primaryKey&&d(N)(a,d(s).primaryKey)?d(N)(a,d(s).primaryKey):b},[O(J,_({id:d(s).primaryKey&&d(N)(a,d(s).primaryKey)?Te(d(N)(a,d(s).primaryKey)):void 0,class:P(a,"row"),variant:d(Y)(a)?a._rowVariant:void 0,tabindex:Ae.value?"0":void 0},{ref_for:!0},ue(a,"row"),{onClick:i=>!d(fe)(i)&&t("row-clicked",a,b,i),onDblclick:i=>!d(fe)(i)&&t("row-dblclicked",a,b,i),onContextmenu:i=>!d(fe)(i)&&t("row-contextmenu",a,b,i),onMouseenter:i=>!d(fe)(i)&&t("row-hovered",a,b,i),onMouseleave:i=>!d(fe)(i)&&t("row-unhovered",a,b,i),onMousedown:i=>_e(a,b,i),onKeydown:i=>be(a,b,i)}),{default:k(()=>[(g(!0),T(ee,null,le($.value,i=>(g(),K(nt($e(i)),_({key:i.key,variant:d(Y)(a)&&a._cellVariants?.[i.key]?null:i.variant,class:q(i,a)},{ref_for:!0},re(a,String(i.key),i.tdAttr)),{default:k(()=>[d(s).stacked&&d(s).labelStacked?(g(),T("label",St,te(d(Ce)(i)),1)):U("",!0),m(o.$slots,y[`cell(${String(i.key)})`]?`cell(${String(i.key)})`:"cell()",{value:d(Ie)(a,String(i.key),i.formatter),unformatted:d(N)(a,String(i.key)),index:b,item:a,field:i,items:o.items,toggleDetails:()=>W(a),detailsShowing:d(Y)(a)?S.value.get(a)??!1:!1},()=>[!y[`cell(${String(i.key)})`]&&!y["cell()"]?(g(),T(ee,{key:0},[se(te(d(Ie)(a,String(i.key),i.formatter)),1)],64)):U("",!0)])]),_:2},1040,["variant","class"]))),128))]),_:2},1040,["id","class","variant","tabindex","onClick","onDblclick","onContextmenu","onMouseenter","onMouseleave","onMousedown","onKeydown"]),d(Y)(a)&&S.value.get(a)===!0&&y["row-details"]?(g(),T(ee,{key:0},[O(J,{"aria-hidden":"true",role:"presentation",class:"d-none"}),O(J,_({class:P(a,"row-details"),variant:a._rowVariant},{ref_for:!0},ue(a,"row-details")),{default:k(()=>[O(ge,{colspan:j.value,class:I(o.detailsTdClass)},{default:k(()=>[m(o.$slots,"row-details",{item:a,toggleDetails:()=>W(a),fields:$.value,index:b})]),_:2},1032,["colspan","class"])]),_:2},1040,["class","variant"])],64)):U("",!0)],64))),128)),!d(s).stacked&&y["bottom-row"]?(g(),K(J,_({key:1,class:["bottom-row",P(null,"row-bottom")]},ue(null,"row-bottom")),{default:k(()=>[m(o.$slots,"bottom-row",{columns:j.value,fields:$.value})]),_:3},16,["class"])):U("",!0)])]),_:3},8,["class"]),d(s).footClone?(g(),K(Le,L(_({key:1},A.value)),{default:k(()=>[O(J,{variant:d(s).footRowVariant??d(s).headRowVariant,class:I(d(s).tfootTrClass??d(s).theadTrClass)},{default:k(()=>[(g(!0),T(ee,null,le($.value,a=>(g(),K(Ve,_({key:a.key,scope:"col",class:he(a),title:a.headerTitle,abbr:a.headerAbbr,style:a.thStyle,variant:a.variant,tabindex:ke(a)?"0":void 0},{ref_for:!0},ne(null,a,"bottom"),{onClick:b=>de(a,b,!0),onKeydown:b=>ye(a,b,!0)}),{default:k(()=>[ve("div",Ct,[ve("div",null,[m(o.$slots,pe(a.key),{label:a.label,column:a.key,field:a,isFoot:!0},()=>[se(te(d(Ce)(a)),1)])])])]),_:2},1040,["class","title","abbr","style","variant","tabindex","onClick","onKeydown"]))),128))]),_:3},8,["variant","class"])]),_:3},16)):y["custom-foot"]?(g(),K(Le,L(_({key:2},A.value)),{default:k(()=>[m(o.$slots,"custom-foot",{fields:$.value,items:d(s).items,columns:j.value})]),_:3},16)):U("",!0),y["table-caption"]||d(s).caption?(g(),T("caption",Bt,[m(o.$slots,"table-caption",{},()=>[se(te(d(s).caption),1)])])):U("",!0)]),_:3},16))}}),Tt=["d"],$t="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z",At="M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4z",De=X({__name:"SortIcon",props:{fieldInfo:{},sortBy:{},initialSortDirection:{}},setup(p){const w=p,l=v(()=>w.sortBy?.find(M=>M.key===w.fieldInfo.key)),s=v(()=>{if(l.value?.order)return l.value.order;const M=w.fieldInfo.initialSortDirection||w.initialSortDirection;return M==="last"?[...w.sortBy??[]].reverse().find(S=>S.order!==void 0)?.order||"asc":M==="desc"?"desc":"asc"}),t=v(()=>s.value==="desc"?At:$t),y=v(()=>s.value==="desc"?"bi bi-arrow-down-short":"bi bi-arrow-up-short"),B=v(()=>l.value?.order?1:.4);return(M,G)=>(g(),T("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",fill:"currentColor",class:I(y.value),style:We({opacity:B.value}),viewBox:"0 0 16 16","aria-hidden":"true"},[ve("path",{"fill-rule":"evenodd",d:t.value},null,8,Tt)],6))}}),Pt={role:"alert","aria-live":"polite"},Rt={class:"text-center my-2"},Vt=X({__name:"BTable",props:Ee({provider:{type:Function,default:void 0},noProvider:{default:void 0},noProviderPaging:{type:Boolean,default:!1},noProviderSorting:{type:Boolean,default:!1},noProviderFiltering:{type:Boolean,default:!1},sortCompare:{type:Function,default:void 0},mustSort:{type:[Boolean,Array],default:!1},initialSortDirection:{default:"asc"},selectable:{type:Boolean,default:!1},multisort:{type:Boolean,default:!1},stickySelect:{type:Boolean,default:!1},selectHead:{type:[Boolean,String],default:!0},selectMode:{default:"multi"},selectionVariant:{default:"primary"},busyLoadingText:{default:"Loading..."},perPage:{default:Number.POSITIVE_INFINITY},currentPage:{default:1},filter:{default:void 0},filterFunction:{type:Function,default:void 0},filterable:{default:void 0},noLocalSorting:{type:Boolean,default:!1},noSelectOnClick:{type:Boolean,default:!1},noSortableIcon:{type:Boolean,default:!1},emptyFilteredText:{default:"There are no records matching your request"},emptyText:{default:"There are no records to show"},showEmpty:{type:Boolean,default:!1},align:{default:void 0},caption:{default:void 0},detailsTdClass:{default:void 0},fieldColumnClass:{type:[Function,String,Object,Array],default:void 0},fields:{default:()=>[]},footClone:{type:Boolean,default:void 0},footRowVariant:{default:void 0},footVariant:{default:void 0},headRowVariant:{default:void 0},headVariant:{default:void 0},items:{default:()=>[]},labelStacked:{type:Boolean,default:void 0},modelValue:{default:void 0},primaryKey:{default:void 0},tbodyClass:{default:void 0},tbodyTrAttrs:{},tbodyTrClass:{type:[Function,String,Array,Object],default:void 0},tfootClass:{default:void 0},tfootTrClass:{default:void 0},theadClass:{default:void 0},theadTrClass:{default:void 0},bordered:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},borderVariant:{default:void 0},captionTop:{type:Boolean,default:void 0},dark:{type:Boolean,default:void 0},fixed:{type:Boolean,default:void 0},hover:{type:Boolean,default:void 0},id:{default:void 0},noBorderCollapse:{type:Boolean,default:void 0},outlined:{type:Boolean,default:void 0},responsive:{type:[Boolean,String],default:void 0},small:{type:Boolean,default:void 0},stacked:{type:[Boolean,String],default:void 0},stickyHeader:{type:[Boolean,String,Number],default:void 0},striped:{type:Boolean,default:void 0},stripedColumns:{type:Boolean,default:void 0},variant:{default:void 0},tableAttrs:{}},{sortBy:{default:void 0},sortByModifiers:{},busy:{type:Boolean,default:!1},busyModifiers:{},selectedItems:{default:()=>[]},selectedItemsModifiers:{}}),emits:Ee(["filtered","row-selected","row-unselected","sorted","change","head-clicked","row-clicked","row-dblclicked","row-contextmenu","row-hovered","row-unhovered","row-middle-clicked"],["update:sortBy","update:busy","update:selectedItems"]),setup(p,{expose:w,emit:l}){const t=ae(p,"BTable"),y=l,B=Ue(),M=v(()=>Object.keys(B).filter(e=>e.startsWith("cell("))),G=v(()=>Object.keys(B).filter(e=>e.startsWith("foot("))),S=Re(p,"sortBy"),z=Re(p,"busy"),$=Re(p,"selectedItems"),j=Ne(()=>t.id),F=v({get:()=>new Set($.value),set:e=>{$.value=[...e]}});oe(F,(e,r)=>{Array.from(r).filter(n=>!e.has(n)).forEach(n=>{y("row-unselected",n)}),Array.from(e).filter(n=>!r.has(n)).forEach(n=>{y("row-selected",n)})});const A={add:e=>{const r=new Set(F.value);r.add(e),F.value=r},clear:()=>{F.value.forEach(e=>{A.delete(e)})},delete:e=>{const r=new Set(F.value);if(t.primaryKey){const n=t.primaryKey;$.value.forEach((u,f)=>{const C=N(u,n),h=N(e,n);C&&h&&C===h&&r.delete($.value[f])})}else r.delete(e);F.value=r},set:e=>{F.value=new Set(e)},has:e=>{if(!t.primaryKey)return F.value.has(e);const r=t.primaryKey;for(const n of F.value){const u=N(n,r),f=N(e,r);if(u&&f&&u===f)return!0}return!1}},pe=ze([]),re=He(()=>t.perPage,{method:"parseInt"}),ne=He(()=>t.currentPage,{method:"parseInt"}),de=v(()=>!!t.filter),W=v(()=>t.provider!==void 0),he=v(()=>F.value.size>0),q=v(()=>S.value!==void 0||t.fields.some(e=>typeof e=="object"&&e!==null&&e.sortable===!0)),_e=v(()=>!!(t.selectable&&!t.noSelectOnClick)),ue=v(()=>!!q.value);dt(Je,{rowNavigation:_e,headerNavigation:ue});const P=v(()=>t.fields.map(e=>{if(!ie(e)){const u=we(e);return{key:e,label:u,tdAttr:Se(t,u)}}const r=S.value?.find(u=>e.key===u.key),n=q.value===!1?void 0:r===void 0?"none":r.order==="desc"?"descending":r.order==="asc"?"ascending":"none";return{...e,thAttr:{"aria-sort":n,...e.thAttr}}})),Te=v(()=>({"b-table-busy":z.value,"b-table-selectable":t.selectable,"user-select-none":t.selectable&&he.value,"b-table-fixed":t.fixed,"b-table-no-border-collapse":t.noBorderCollapse})),$e=v(()=>[t.tbodyTrClass?typeof t.tbodyTrClass=="function"?t.tbodyTrClass(null,"table-busy"):t.tbodyTrClass:null]),ke=e=>[{"b-table-sortable-column":q.value&&e.sortable}],Ae=(e,r)=>[{[`selected table-${t.selectionVariant}`]:t.selectable&&!!e&&A.has(e)},t.tbodyTrClass?typeof t.tbodyTrClass=="function"?t.tbodyTrClass(e,r):t.tbodyTrClass:null],ye=e=>typeof e.sortByFormatted=="function"?e.sortByFormatted:e.formatter,be=(e,r)=>{if(!Y(e))return String(e);const n=P.value.find(f=>ie(f)?f.key===r:!1),u=N(e,r);if(ie(n)&&n.sortByFormatted){const f=ye(n);if(f)return String(Ie(e,String(n.key),f))}return typeof u=="object"&&u!==null?JSON.stringify(u):u?.toString()??""},Pe=v(()=>{const e=new Map;for(const r of P.value)ie(r)&&e.set(r.key,r);return e}),V=v(()=>{const e=S.value?.filter(f=>!!f.order),r=f=>{if(typeof f=="object"&&f!==null&&Object.keys(f).some(C=>C.includes("."))){let C={};for(const h in f)h.includes(".")?C=et(C,h,f[h]):C[h]=f[h];return C}return f},n=f=>Y(f)?Object.entries(f).some(([C,h])=>h==null||C[0]==="_"||!t.filterable?.includes(C)&&t.filterable?.length?!1:t.filterFunction&&typeof t.filterFunction=="function"?t.filterFunction(f,t.filter):(()=>{const Q=P.value.find(x=>ie(x)?x.key===C:!1);if(ie(Q)&&Q.filterByFormatted){const x=ye(Q);if(x)return String(x(h,String(Q.key),f))}return typeof h=="object"?JSON.stringify(Object.values(h)):h.toString()})().toLowerCase().includes(t.filter?.toLowerCase()??"")):!0,u=(W.value?pe.value:t.items).reduce((f,C)=>{const h=r(C);return(!(de.value&&(!W.value||t.noProviderFiltering))||n(h))&&f.push(h),f},[]);return e?.length&&(q.value===!0&&!W.value&&!t.noLocalSorting||q.value===!0&&W.value&&t.noProviderSorting)?u.sort((f,C)=>{for(let h=0;h<e.length;h++){const{key:H,order:Z}=e[h],x=Pe.value.get(H)?.sortCompare||t.sortCompare,R=x?x(f,C,H):be(f,H).localeCompare(be(C,H),void 0,{numeric:!0});if(R!==0)return Z==="asc"?R:-R}return 0}):u}),o=v(()=>({emptyFilteredText:t.emptyFilteredText,emptyText:t.emptyText,fields:P.value,items:V.value})),c=v(()=>Number.isNaN(re.value)||W.value&&!t.noProviderPaging?V.value:V.value.slice((ne.value-1)*(re.value||Number.POSITIVE_INFINITY),ne.value*(re.value||Number.POSITIVE_INFINITY)));oe(c,e=>{y("change",e)});const a=(e,r,n=!1,u=!1,f=!1)=>{if(t.selectable)if(t.selectMode==="single"||t.selectMode==="multi"){if(n||u)return;A.has(e)?A.delete(e):t.selectMode==="single"?A.set([e]):A.add(e)}else if(u||f)A.has(e)?A.delete(e):A.add(e);else if(n){const C=[...F.value].pop(),h=V.value.findIndex(x=>x===C),H=Math.min(h,r),Z=Math.max(h,r),Q=V.value.slice(H,Z+1);A.set(Q)}else A.set([e])},b=e=>{if(!q.value)return;const r=typeof e=="object"&&e!==null?e.key:e,n=typeof e=="object"&&e!==null?e.sortable:!1;if(!(q.value===!0&&n===!0))return;const u=()=>[...S.value??[]].reverse().find(D=>D.order!==void 0&&D.key!==r)?.order??"asc",f=()=>typeof e=="object"&&e!==null&&e.initialSortDirection?e.initialSortDirection==="last"?u():e.initialSortDirection:t.initialSortDirection?t.initialSortDirection==="last"?u():t.initialSortDirection:"asc",C=R=>{if(R===void 0)return f();const D=f(),me=t.mustSort===!0||Array.isArray(t.mustSort)&&t.mustSort.includes(r);if(R==="asc")return D==="desc"?me?"desc":void 0:"desc";if(R==="desc")return D==="desc"||me?"asc":void 0},h=S.value?.findIndex(R=>R.key===r)??-1,H=S.value?.[h],Z=h===-1||!H?{key:r,order:f()}:{...H},Q=()=>{const R=[...S.value??[]],D=Z;if(h===-1)R.push(D);else{const me=C(D.order);me?(D.order=me,R.splice(h,1,D)):(D.order=void 0,R.splice(h,1))}return S.value=R,D},x=()=>{const R=h===-1?Z.order:C(Z.order),D={...Z,order:R};return S.value=R?[D]:[],D};y("sorted",t.multisort===!0?Q():x())},i=async()=>{if(!W.value||t.provider===void 0||z.value)return;z.value=!0;const e=t.provider({currentPage:ne.value,filter:t.filter,sortBy:S.value,perPage:re.value});try{const r=e instanceof Promise?await e:e;if(r===void 0)return;pe.value=r}finally{z.value=!1}},ce=async(e,r,n)=>{if(it(r,n))return;const u=H=>t.noProvider?.includes(H)===!0,f=(e==="currentPage"||e==="perPage")&&(u("paging")||t.noProviderPaging===!0),C=e==="filter"&&(u("filtering")||t.noProviderFiltering===!0),h=(e==="sortBy"||e==="sortDesc")&&(u("sorting")||t.noProviderSorting===!0);f||C||h||(W.value===!0&&await i(),e==="currentPage"||e==="perPage"||y("filtered",[...V.value]))};oe(()=>t.filter,(e,r)=>{ce("filter",e,r),!(e===r||W.value)&&(e||y("filtered",[...V.value]))}),oe(ne,(e,r)=>{ce("currentPage",e,r)}),oe(re,(e,r)=>{ce("perPage",e,r)}),oe(S,(e,r)=>{ce("sortBy",e,r)},{deep:!0}),oe(()=>t.provider,e=>{if(e===void 0){pe.value=[];return}i()}),tt(i);const E={clearSelected:()=>{t.selectable&&A.clear()},selectAllRows:()=>{!t.selectable||t.selectMode==="single"||(F.value=new Set(V.value))},selectRow:e=>{if(!t.selectable)return;const r=V.value[e];!r||A.has(r)||(t.selectMode==="single"?A.set([r]):A.add(r))},unselectRow:e=>{if(!t.selectable)return;const r=V.value[e];!r||!A.has(r)||A.delete(r)},isRowSelected:e=>{if(!t.selectable)return!1;const r=V.value[e];return A.has(r)}},Xe={onHeadClicked:(e,r,n,u=!1)=>{y("head-clicked",e,r,n,u),b(r)},onRowClicked:(e,r,n)=>{t.noSelectOnClick===!1&&a(e,r,n.shiftKey,n.ctrlKey,n.metaKey),y("row-clicked",e,r,n)},onRowDblclicked:(...e)=>y("row-dblclicked",...e),onRowContextmenu:(...e)=>y("row-contextmenu",...e),onRowHovered:(...e)=>y("row-hovered",...e),onRowUnhovered:(...e)=>y("row-unhovered",...e),onRowMiddleClicked:(...e)=>y("row-middle-clicked",...e)},Ge=v(()=>({...qe(t,[...at,...Ye]),tableAttrs:{ariaBusy:z.value},items:c.value,fields:P.value,tableClass:Te.value,tbodyTrClass:Ae,fieldColumnClass:ke,id:j.value,...Xe}));return w({...E,items:V,displayItems:c,getStringValue:be,refresh:i}),(e,r)=>(g(),K(_t,L(Be(Ge.value)),ot({"custom-body":k(n=>[z.value&&B["table-busy"]?(g(),K(J,{key:0,class:I(["b-table-busy-slot",$e.value])},{default:k(()=>[O(ge,{colspan:n.fields.length},{default:k(()=>[m(e.$slots,"table-busy")]),_:2},1032,["colspan"])]),_:2},1032,["class"])):d(t).showEmpty===!0&&V.value.length===0?(g(),K(J,{key:1,class:"b-table-empty-row"},{default:k(()=>[O(ge,{colspan:P.value.length},{default:k(()=>[ve("div",Pt,[ve("div",Rt,[de.value?m(e.$slots,"empty-filtered",L(_({key:0},o.value)),()=>[se(te(d(t).emptyFilteredText),1)]):m(e.$slots,"empty",L(_({key:1},o.value)),()=>[se(te(d(t).emptyText),1)])])])]),_:3},8,["colspan"])]),_:3})):U("",!0)]),_:2},[B["table-colgroup"]?{name:"table-colgroup",fn:k(n=>[m(e.$slots,"table-colgroup",L(Be(n)))]),key:"0"}:void 0,B["thead-top"]?{name:"thead-top",fn:k(n=>[m(e.$slots,"thead-top",_(n,{clearSelected:E.clearSelected,selectAllRows:E.selectAllRows,fields:P.value}))]),key:"1"}:void 0,B["thead-sub"]?{name:"thead-sub",fn:k(n=>[m(e.$slots,"thead-sub",_(n,{fields:P.value}))]),key:"2"}:void 0,B["top-row"]?{name:"top-row",fn:k(n=>[m(e.$slots,"top-row",_(n,{fields:P.value}))]),key:"3"}:void 0,B["row-details"]?{name:"row-details",fn:k(n=>[m(e.$slots,"row-details",_(n,{fields:P.value,selectRow:(u=n.index)=>E.selectRow(u),unselectRow:(u=n.index)=>E.unselectRow(u),rowSelected:E.isRowSelected(n.index)}))]),key:"4"}:void 0,B["bottom-row"]?{name:"bottom-row",fn:k(n=>[m(e.$slots,"bottom-row",_(n,{fields:P.value}))]),key:"5"}:void 0,B["custom-foot"]?{name:"custom-foot",fn:k(n=>[m(e.$slots,"custom-foot",_(n,{fields:P.value}))]),key:"6"}:void 0,B["table-caption"]?{name:"table-caption",fn:k(()=>[m(e.$slots,"table-caption")]),key:"7"}:void 0,le(M.value,n=>({name:n,fn:k(u=>[m(e.$slots,n,_(u,{selectRow:(f=u.index)=>E.selectRow(f),unselectRow:(f=u.index)=>E.unselectRow(f),rowSelected:E.isRowSelected(u.index)}))])})),le(G.value,n=>({name:n,fn:k(u=>[m(e.$slots,n,_(u,{selectAllRows:E.selectAllRows,clearSelected:E.clearSelected}))])})),le(P.value,n=>({name:`head(${String(n.key)})`,fn:k(u=>[m(e.$slots,B[`head(${String(n.key)})`]?`head(${String(n.key)})`:"head()",_(u,{selectAllRows:E.selectAllRows,clearSelected:E.clearSelected}),()=>[se(te(d(Ce)(n)),1)]),q.value&&u.field.sortable&&d(t).noSortableIcon===!1?(g(),T(ee,{key:0},[S.value?.find(f=>f.key===u.field.key)?.order==="asc"?m(e.$slots,B[`sortAsc(${String(u.field.key)})`]?`sortAsc(${String(u.field.key)})`:"sortAsc()",L(_({key:0},u)),()=>[O(De,{"field-info":u.field,"sort-by":S.value,"initial-sort-direction":d(t).initialSortDirection},null,8,["field-info","sort-by","initial-sort-direction"])]):S.value?.find(f=>f.key===u.field.key)?.order==="desc"?m(e.$slots,B[`sortDesc(${String(u.field.key)})`]?`sortDesc(${String(u.field.key)})`:"sortDesc()",L(_({key:1},u)),()=>[O(De,{"field-info":u.field,"sort-by":S.value,"initial-sort-direction":d(t).initialSortDirection},null,8,["field-info","sort-by","initial-sort-direction"])]):m(e.$slots,B[`sortDefault(${String(u.field.key)})`]?`sortDefault(${String(u.field.key)})`:"sortDefault()",L(_({key:2},u)),()=>[O(De,{"field-info":u.field,"sort-by":S.value,"initial-sort-direction":d(t).initialSortDirection},null,8,["field-info","sort-by","initial-sort-direction"])])],64)):U("",!0)])}))]),1040))}});export{Vt as _};
